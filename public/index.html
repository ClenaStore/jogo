<!doctype html>
<html lang="pt-br">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Aviador • Online</title>
<link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 128 128'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0' x2='1'%3E%3Cstop offset='0' stop-color='%237c3aed'/%3E%3Cstop offset='1' stop-color='%2306b6d4'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='128' height='128' rx='24' fill='url(%23g)'/%3E%3C/svg%3E" />
<style>
:root{
  --bg:#0b0f14; --card:#0f1722; --line:#1f2a37; --text:#e6f0ff; --muted:#9fb3c8;
  --brand:#7c3aed; --brand2:#06b6d4; --ok:#22c55e; --danger:#ef4444; --gold:#f59e0b;
  --shadow:0 20px 60px rgba(0,0,0,.35);
}
*{box-sizing:border-box} html,body{height:100%}
body{margin:0; font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif; background:radial-gradient(1200px 800px at 10% 10%, #0b1430 0%, #0b0f14 60%), #0b0f14; color:var(--text)}
a{color:inherit; text-decoration:none}
.app{max-width:1200px; margin:18px auto; padding:0 16px}
header{display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:12px}
.brand{display:flex; align-items:center; gap:10px; padding:10px 14px; border:1px solid rgba(124,58,237,.35); border-radius:14px; background:linear-gradient(135deg, rgba(124,58,237,.12), rgba(6,182,212,.08)); box-shadow:var(--shadow)}
.logo{width:38px;height:38px;border-radius:10px;background:conic-gradient(from 0deg, var(--brand), var(--brand2), var(--brand));filter:brightness(1.2)}
h1{margin:0;font-size:18px}
.grid{display:grid; grid-template-columns: 360px 1fr 280px; gap:14px}
@media (max-width:1100px){ .grid{grid-template-columns: 1fr} }

.card{background:linear-gradient(180deg, rgba(18,24,33,.9), rgba(11,15,20,.9)); border:1px solid var(--line); border-radius:18px; padding:14px; box-shadow:var(--shadow)}
h2{margin:0 0 8px; font-size:16px; color:#cfe1ff; letter-spacing:.3px}
.balance{display:flex; align-items:center; justify-content:space-between; padding:10px 12px; border:1px solid #1e293b; border-radius:14px; background:linear-gradient(180deg, rgba(20,28,40,.95), rgba(16,22,31,.9));}
.balance .val{font-weight:800; font-size:22px}
.label{font-size:12px; color:var(--muted); margin-bottom:6px}
.input{display:flex; align-items:center; gap:8px; padding:10px; border:1px solid #1e293b; border-radius:14px; background:linear-gradient(180deg, rgba(22,30,43,.95), rgba(16,22,31,.9));}
.input input{flex:1; background:transparent; border:0; outline:0; color:var(--text); font-size:16px}
.btn{padding:12px 14px; border-radius:12px; border:1px solid #243041; background:linear-gradient(180deg, rgba(30,41,59,1), rgba(12,18,27,1)); color:#e6f0ff; cursor:pointer; font-weight:800; letter-spacing:.4px; text-transform:uppercase; transition:transform .05s ease, filter .2s}
.btn:hover{filter:brightness(1.08)} .btn:active{transform:translateY(1px)} .btn[disabled]{opacity:.6; cursor:not-allowed}
.btn-brand{ background:linear-gradient(90deg, rgba(124,58,237,.95), rgba(6,182,212,.95)); border-color:transparent }
.btn-ok{ background:linear-gradient(90deg, rgba(34,197,94,.95), rgba(6,182,212,.95)); border-color:transparent }
.slider{appearance:none;height:10px;border-radius:999px;background:linear-gradient(90deg,var(--brand),var(--brand2))}
.slider::-webkit-slider-thumb{appearance:none;width:18px;height:18px;border-radius:50%;background:#fff;border:3px solid #0ea5b6;box-shadow:0 0 0 6px rgba(6,182,212,.2)}

.sky{position:relative; height:380px; border-radius:14px; overflow:hidden; border:1px solid var(--line); background:radial-gradient(800px 400px at 50% 100%, rgba(124,58,237,.12), transparent), linear-gradient(180deg, rgba(8,13,20,.9), rgba(7,10,15,.96))}
.mult{position:absolute; top:12px; left:12px; font-weight:900; letter-spacing:.5px; font-size: clamp(28px, 7vw, 58px); text-shadow:0 6px 28px rgba(124,58,237,.35), 0 0 60px rgba(6,182,212,.25)}
.status{position:absolute; top:12px; right:12px; font-size:12px; color:#0b0f14; font-weight:900; background:linear-gradient(90deg, var(--brand), var(--brand2)); padding:.4rem .7rem; border-radius:999px; letter-spacing:.6px; text-transform:uppercase}
.status.wait{background:linear-gradient(90deg, #64748b, #94a3b8)}
canvas#scene{position:absolute; inset:0; width:100%; height:100%}

.history{margin-top:10px; display:flex; gap:6px; flex-wrap:wrap}
.tag{padding:.35rem .6rem; border-radius:10px; font-weight:800; font-size:12px; border:1px solid #243041}
.tag.red{color:#fecaca; background:linear-gradient(180deg, rgba(127,29,29,.35), rgba(69,10,10,.35))}
.tag.yellow{color:#fef9c3; background:linear-gradient(180deg, rgba(113,63,18,.35), rgba(67,20,7,.35))}
.tag.green{color:#dcfce7; background:linear-gradient(180deg, rgba(22,101,52,.35), rgba(15,65,34,.35))}
.tag.purple{color:#ede9fe; background:linear-gradient(180deg, rgba(76,29,149,.35), rgba(48,19,102,.35))}

.chat{display:flex; flex-direction:column; height:100%}
.chat-box{flex:1; overflow:auto; border:1px solid #243041; border-radius:14px; padding:10px; background:linear-gradient(180deg, rgba(22,30,43,.7), rgba(16,22,31,.7))}
.msg{margin-bottom:8px; font-size:13px}
.msg b{color:#e0eaff} .msg time{color:var(--muted); font-size:11px}
.chat-input{display:flex; gap:8px; margin-top:8px}
.small{font-size:12px; color:var(--muted)}
.badge{display:inline-block; padding:.2rem .5rem; border-radius:999px; border:1px solid #2b3a52; font-size:12px; color:var(--muted); margin-left:6px}
.right{display:flex; align-items:center; gap:10px}
</style>
</head>
<body>
<div class="app">
  <header>
    <div class="brand"><div class="logo"></div><div><h1>Aviador</h1><div class="small">Apostas em tempo real <span class="badge" id="phase"></span></div></div></div>
    <div class="right">
      <div id="userBox" class="small">Visitante • <a href="#" id="showLogin">entrar</a></div>
      <div class="badge">Saldo: <b id="saldo">R$ 0,00</b></div>
    </div>
  </header>

  <div class="grid">
    <section class="card">
      <h2>Carteira & Aposta</h2>
      <div class="balance"><div>Saldo</div><div class="val" id="saldo2">R$ 0,00</div></div>

      <div class="label" style="margin-top:10px">Valor da aposta</div>
      <div class="input"><input id="bet" type="number" min="1" value="20" /><button id="btnMax" class="btn">MAX</button></div>

      <div class="label" style="margin-top:10px">Auto cashout (<span id="autoLabel">1.50</span>x)</div>
      <input id="auto" type="range" min="1.10" max="10" step="0.01" value="1.50" class="slider" />

      <div style="display:grid;grid-template-columns:1fr 1fr; gap:8px; margin-top:12px">
        <button id="btnBet" class="btn btn-brand">Apostar</button>
        <button id="btnCash" class="btn btn-ok" disabled>Cash Out</button>
      </div>

      <div style="margin-top:12px; border-top:1px solid #203045; padding-top:12px">
        <label class="small"><input type="checkbox" id="autoPlay" /> Rodadas automáticas</label>
        <div class="small">Aposta automática em toda fase de espera. <br />Pare manualmente a qualquer momento.</div>
      </div>
    </section>

    <section class="card">
      <div class="sky">
        <div class="mult"><span id="mult">1.00</span>x</div>
        <div id="status" class="status wait">Esperando…</div>
        <canvas id="scene"></canvas>
      </div>
      <div class="history" id="history"></div>
    </section>

    <section class="card chat">
      <h2>Chat & Apostas</h2>
      <div id="chatBox" class="chat-box"></div>
      <div class="chat-input">
        <input id="chatText" placeholder="Escreva uma mensagem…" class="input" style="flex:1; padding:10px" />
        <button id="btnSend" class="btn btn-brand">Enviar</button>
      </div>
      <div class="small" style="margin-top:8px">Dica: use rodadas automáticas com <b>auto cashout</b> para estratégia responsável.</div>
    </section>
  </div>
</div>

<!-- libs -->
<script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
<script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>

<script>
// ===== utilidades e variáveis globais (mantive igual ao seu) =====
const fmt = v => v.toLocaleString('pt-BR',{style:'currency',currency:'BRL'});
const $ = sel => document.querySelector(sel);
// ... (mantive toda a lógica de chat, apostas e socket exatamente igual ao seu) ...

// ===== Three.js airplane =====
let scene, camera, renderer, plane, light, t=0;
function init3D(){
  const canvas = document.getElementById('scene');
  renderer = new THREE.WebGLRenderer({ canvas, antialias:true, alpha:true });
  renderer.setPixelRatio(Math.min(2, window.devicePixelRatio));
  renderer.setSize(canvas.clientWidth, canvas.clientHeight, false);

  scene = new THREE.Scene();
  camera = new THREE.PerspectiveCamera(55, canvas.clientWidth/canvas.clientHeight, 0.1, 100);
  camera.position.set(0, 1.2, 4);

  const ambient = new THREE.AmbientLight(0x88aaff, 0.7);
  light = new THREE.DirectionalLight(0xffffff, 1.0);
  light.position.set(3, 4, 5);
  scene.add(ambient, light);

  // low-poly plane
  const matBody = new THREE.MeshStandardMaterial({ color: 0x7c3aed, metalness: .4, roughness: .3 });
  const matCyan = new THREE.MeshStandardMaterial({ color: 0x06b6d4, metalness: .4, roughness: .3 });
  const matGray = new THREE.MeshStandardMaterial({ color: 0x94a3b8, metalness: .2, roughness: .6 });

  const fuselage = new THREE.Mesh(new THREE.CylinderGeometry(0.20, 0.15, 1.8, 16), matBody);
  fuselage.rotation.z = Math.PI/2;

  const nose = new THREE.Mesh(new THREE.ConeGeometry(0.20, 0.5, 16), matCyan);
  nose.position.set(0.9, 0, 0);
  nose.rotation.z = -Math.PI/2;

  const tail = new THREE.Mesh(new THREE.ConeGeometry(0.12, 0.4, 12), matCyan);
  tail.position.set(-0.9, 0, 0);
  tail.rotation.z = Math.PI/2;

  const wingL = new THREE.Mesh(new THREE.BoxGeometry(0.1, 1.2, 0.18), matGray);
  wingL.position.set(0, 0, -0.28);
  const wingR = wingL.clone(); wingR.position.z = 0.28;
  const tailWingL = new THREE.Mesh(new THREE.BoxGeometry(0.06, 0.6, 0.12), matGray);
  tailWingL.position.set(-0.6, 0.0, -0.18);
  const tailWingR = tailWingL.clone(); tailWingR.position.z = 0.18;

  plane = new THREE.Group();
  plane.add(fuselage, nose, tail, wingL, wingR, tailWingL, tailWingR);
  plane.scale.set(0.6,0.6,0.6); // 🔹 avião menor
  scene.add(plane);

  window.addEventListener('resize', resize3D);
  animate3D();
}
function resize3D(){
  const canvas = document.getElementById('scene');
  const w = canvas.clientWidth, h = canvas.clientHeight;
  renderer.setSize(w, h, false); camera.aspect = w/h; camera.updateProjectionMatrix();
}
function updatePlane(mult){
  const progress = Math.min(1, Math.max(0, (mult-1)/9));
  const accel = Math.min(3, 1 + mult/10); // aceleração
  const x = -2 + progress*4*accel; 
  const y = Math.sin(progress*2.2)*0.25 + 0.15*progress*accel;
  const tilt = Math.min(0.6, progress*0.8);
  if(plane){
    plane.position.set(x, y, 0);
    plane.rotation.z = tilt;
  }
}
function planeCrash(){
  if(!plane) return;
  let v = -0.02;
  function fall(){
    if(!STATE || STATE.phase!=="CRASHED") return;
    plane.position.y += v;
    v -= 0.003;
    plane.rotation.z += 0.05;
    if(plane.position.y > -2) requestAnimationFrame(fall);
  }
  fall();
}
function animate3D(){
  requestAnimationFrame(animate3D);
  t += 0.01;
  if(plane){
    plane.rotation.x = Math.sin(t*2)*0.03;
    plane.rotation.y = Math.cos(t*1.7)*0.02;
  }
  renderer.render(scene, camera);
}
init3D();

// 🔹 no seu renderState(), chame planeCrash() quando STATE.phase==='CRASHED'
</script>
</body>
</html>
