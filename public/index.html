<!doctype html>
<html lang="pt-br">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Aviador Online</title>
<style>
:root{
  --bg:#05080d; --brand:#7c3aed; --brand2:#06b6d4; --ok:#22c55e; --danger:#ef4444;
}
*{box-sizing:border-box}
body{margin:0; font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif; background:var(--bg); color:#eee; overflow-x:hidden;}
canvas{display:block;width:100%;height:100%}

#hud{position:absolute;top:10px;left:10px;z-index:10;font-weight:bold}
#hud span{font-size:32px;color:var(--brand);text-shadow:0 0 20px var(--brand),0 0 40px var(--brand2)}
#status{display:block;margin-top:4px;font-size:14px;color:#ccc}
#userBox{position:absolute;top:10px;right:10px;z-index:10;font-size:14px}
#userBox button{background:linear-gradient(90deg,var(--brand),var(--brand2));border:none;color:#fff;padding:6px 10px;border-radius:6px;cursor:pointer;font-weight:600}

/* √Årea inferior (apostas + ranking) */
#bottomArea{
  display:flex;
  flex-direction:column;
  gap:12px;
  position:relative;
  z-index:15;
  width:100%;
  padding:12px;
  background:rgba(0,0,0,.65);
}
#betButtons{display:flex;gap:10px;justify-content:center}
#betButtons button{flex:1;padding:12px;font-weight:700;border:none;border-radius:8px;cursor:pointer;color:#fff;background:linear-gradient(90deg,var(--brand),var(--brand2));}
#betButtons button:active{transform:scale(.97)}

#ranking{margin-top:6px}
#ranking h3{margin:0 0 6px;font-size:16px;color:#fff;text-align:center}
.rank-item{display:flex;justify-content:space-between;padding:6px 10px;border-radius:6px;margin-bottom:4px;font-size:14px}
.rank-item.win{background:rgba(34,197,94,.15);color:var(--ok)}
.rank-item.lose{background:rgba(239,68,68,.15);color:var(--danger)}

/* Modal login */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.7);display:flex;align-items:center;justify-content:center;z-index:20}
.modal-content{background:#0f1722;padding:20px;border-radius:12px;box-shadow:0 0 20px #000;width:90%;max-width:320px;text-align:center}
.modal-content h2{margin:0 0 12px;font-size:20px;color:#fff}
.modal-content input{width:100%;padding:10px;margin:6px 0;border:1px solid #333;border-radius:8px;background:#111;color:#eee}
.modal-content button{width:100%;margin-top:10px;padding:10px;background:linear-gradient(90deg,var(--brand),var(--brand2));border:none;border-radius:8px;color:#fff;font-weight:600;cursor:pointer}
.modal-content small{display:block;margin-top:8px;color:#aaa;cursor:pointer}

@media(min-width:900px){
  #bottomArea{position:absolute;bottom:0;left:0;right:0;background:rgba(0,0,0,.4);flex-direction:row;justify-content:space-between;align-items:flex-start}
  #betButtons{flex:1;max-width:300px}
  #ranking{flex:1;max-width:300px}
}
</style>
</head>
<body>
<div id="hud">
  <span id="mult">1.00</span>x
  <div id="status">Esperando‚Ä¶</div>
</div>
<div id="userBox"></div>
<canvas id="scene"></canvas>

<!-- √Årea inferior -->
<div id="bottomArea">
  <div id="betButtons">
    <button onclick="apostar()">Apostar R$20</button>
    <button onclick="cashout()">Cash Out</button>
  </div>
  <div id="ranking">
    <h3>üèÜ Top 5 Apostas</h3>
    <div id="rankList"></div>
  </div>
</div>

<!-- Modal login -->
<div class="modal" id="loginModal">
  <div class="modal-content">
    <h2 id="modalTitle">Entrar</h2>
    <input type="text" id="nameField" placeholder="Nome" style="display:none">
    <input type="email" id="emailField" placeholder="Email">
    <input type="password" id="passField" placeholder="Senha">
    <button id="submitBtn">Entrar</button>
    <small id="toggleMode">N√£o tem conta? Cadastre-se</small>
  </div>
</div>

<script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>
<script>
// ===== Avi√£o + cena =====
let scene,camera,renderer,plane,trailGeom,trailMat,trailLine,particles=[];
let STATE={phase:"WAITING",multiplier:1,crashAt:5};
let mult=1,running=false,trailPts=[];
const canvas=document.getElementById("scene");
renderer=new THREE.WebGLRenderer({canvas,antialias:true,alpha:true});
renderer.setPixelRatio(window.devicePixelRatio);
renderer.setSize(window.innerWidth,window.innerHeight);
scene=new THREE.Scene();
camera=new THREE.PerspectiveCamera(65,window.innerWidth/window.innerHeight,0.1,100);
camera.position.set(0,1.5,6);
scene.add(new THREE.AmbientLight(0x99aaff,.7));
const dir=new THREE.DirectionalLight(0xffffff,1); dir.position.set(4,6,5); scene.add(dir);

function buildPlane(){
  const mat1=new THREE.MeshStandardMaterial({color:0x7c3aed,metalness:.6,roughness:.3,emissive:0x220044,emissiveIntensity:.5});
  const mat2=new THREE.MeshStandardMaterial({color:0x06b6d4,emissive:0x003355,emissiveIntensity:.8});
  const fus=new THREE.Mesh(new THREE.CylinderGeometry(0.15,0.12,1.2,16),mat1); fus.rotation.z=Math.PI/2;
  const nose=new THREE.Mesh(new THREE.ConeGeometry(0.15,0.3,16),mat2); nose.position.set(0.65,0,0); nose.rotation.z=-Math.PI/2;
  const wing=new THREE.Mesh(new THREE.BoxGeometry(0.06,0.8,0.12),mat2); wing.position.set(0,0,-0.2);
  const wing2=wing.clone(); wing2.position.z=0.2;
  plane=new THREE.Group(); plane.add(fus,nose,wing,wing2);
  plane.scale.set(0.35,0.35,0.35);
  scene.add(plane);
}
buildPlane();

trailGeom=new THREE.BufferGeometry().setFromPoints([new THREE.Vector3()]);
trailMat=new THREE.LineBasicMaterial({color:0x06b6d4});
trailLine=new THREE.Line(trailGeom,trailMat); scene.add(trailLine);

window.addEventListener("resize",()=>{renderer.setSize(window.innerWidth,window.innerHeight);camera.aspect=window.innerWidth/window.innerHeight;camera.updateProjectionMatrix();});

function updatePlane(mult){
  const progress=(mult-1)/5;
  const x=-2+progress*6;
  const y=Math.sin(progress*3)*0.4+0.15*progress;
  plane.position.set(x,y,0);
  plane.rotation.z=Math.min(0.7,progress*1.2);
  trailPts.push(new THREE.Vector3(x,y,0));
  if(trailPts.length>200) trailPts.shift();
  trailGeom.setFromPoints(trailPts);
}
function planeCrash(){let v=-0.05;function fall(){if(STATE.phase!=="CRASHED")return;plane.position.y+=v;v-=0.005;plane.rotation.z+=0.12;if(plane.position.y>-3){requestAnimationFrame(fall);}else explode();}fall();}
function explode(){for(let i=0;i<100;i++){particles.push({x:plane.position.x,y:plane.position.y,vx:(Math.random()-.5)*.2,vy:(Math.random()*.2),life:60});}}
function drawParticles(){const geom=new THREE.SphereGeometry(0.03,6,6);const mat=new THREE.MeshBasicMaterial({color:0xffaa00});particles.forEach(p=>{p.x+=p.vx;p.y+=p.vy;p.vy-=0.003;p.life--;if(p.life>0){const m=new THREE.Mesh(geom,mat);m.position.set(p.x,p.y,0);scene.add(m);setTimeout(()=>scene.remove(m),50);}});particles=particles.filter(p=>p.life>0);}
function animate(){requestAnimationFrame(animate);if(STATE.phase==="FLYING")updatePlane(STATE.multiplier);drawParticles();renderer.render(scene,camera);}animate();

function startRound(){
  running=true; mult=1; STATE.phase="FLYING"; STATE.crashAt=2+Math.random()*6;
  document.getElementById("status").textContent="Em voo";
  const id=setInterval(()=>{
    mult*=1.1; STATE.multiplier=mult;
    document.getElementById("mult").textContent=mult.toFixed(2);
    if(mult>=STATE.crashAt){
      clearInterval(id);
      STATE.phase="CRASHED";
      document.getElementById("status").textContent="Crash "+STATE.crashAt.toFixed(2)+"x";
      planeCrash();
      running=false;
      mult=1;
      setTimeout(()=>{
        STATE.phase="WAITING";
        document.getElementById("status").textContent="Esperando‚Ä¶";
        trailPts=[];
      },2500);
      atualizarRanking(); // üîπ atualiza ranking ao crash
    }
  },140);
}
setInterval(()=>{ if(!running&&STATE.phase==="WAITING"){ startRound(); } },2000);

// ===== Bot√µes fake =====
function apostar(){alert("Aposta registrada!");}
function cashout(){alert("Cash Out realizado!");}

// ===== Ranking fake =====
const jogadores=["Ana","Bruno","Carlos","Daniela","Eduardo","Fernanda","Gabriel","Helena"];
function atualizarRanking(){
  const rankList=document.getElementById("rankList");
  rankList.innerHTML="";
  let apostas=[];
  for(let i=0;i<5;i++){
    const nome=jogadores[Math.floor(Math.random()*jogadores.length)];
    const valor=Math.floor(Math.random()*500)+50;
    const win=Math.random()>0.5;
    apostas.push({nome,valor,win});
  }
  apostas.sort((a,b)=>b.valor-a.valor);
  apostas.forEach(a=>{
    const div=document.createElement("div");
    div.className="rank-item "+(a.win?"win":"lose");
    div.textContent=`${a.nome} ‚Ä¢ R$${a.valor} ‚Ä¢ ${a.win?"Venceu":"Perdeu"}`;
    rankList.appendChild(div);
  });
}

// ===== Login/Cadastro Fake =====
let users=JSON.parse(localStorage.getItem("users")||"{}");
let currentUser=null;
function showUserBox(){
  const box=document.getElementById("userBox");
  if(currentUser){
    box.innerHTML=`Ol√°, ${currentUser.name} | Saldo: R$1000 <button onclick="logout()">Sair</button>`;
  }else{
    box.innerHTML=`<button onclick="openLogin()">Entrar</button>`;
  }
}
function openLogin(){document.getElementById("loginModal").style.display="flex";}
function logout(){currentUser=null;localStorage.removeItem("aviador_user");showUserBox();}
document.getElementById("toggleMode").onclick=function(){
  const nameF=document.getElementById("nameField"),title=document.getElementById("modalTitle"),btn=document.getElementById("submitBtn");
  if(nameF.style.display==="none"){
    nameF.style.display="block";title.textContent="Cadastro";btn.textContent="Cadastrar";this.textContent="J√° tem conta? Entrar";
  }else{
    nameF.style.display="none";title.textContent="Entrar";btn.textContent="Entrar";this.textContent="N√£o tem conta? Cadastre-se";
  }
};
document.getElementById("submitBtn").onclick=function(){
  const name=document.getElementById("nameField").value||"Jogador";
  const email=document.getElementById("emailField").value;
  const pass=document.getElementById("passField").value;
  const isReg=document.getElementById("nameField").style.display==="block";
  if(!email||!pass){alert("Preencha os campos");return;}
  if(isReg){
    if(users[email]){alert("Email j√° cadastrado!");return;}
    users[email]={name,email,pass};
    localStorage.setItem("users",JSON.stringify(users));
    alert("Cadastrado com sucesso! Agora entre.");
    document.getElementById("toggleMode").click();
  }else{
    if(users[email]&&users[email].pass===pass){
      currentUser=users[email];
      localStorage.setItem("aviador_user",JSON.stringify(currentUser));
      document.getElementById("loginModal").style.display="none";
      showUserBox();
    }else{alert("Credenciais inv√°lidas");}
  }
};
currentUser=JSON.parse(localStorage.getItem("aviador_user")||"null");
showUserBox();
</script>
</body>
</html>
