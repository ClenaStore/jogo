<!doctype html>
<html lang="pt-br">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Aviador • Demo (somente créditos virtuais)</title>
<style>
  /* ===== Tema Neon / Arcadia ===== */
  :root{
    --bg:#0b0f14;        /* fundo base */
    --bg-2:#0f1722;      /* fundo cards */
    --line:#1f2a37;      /* linhas */
    --text:#e6f0ff;      /* texto primário */
    --muted:#9fb3c8;     /* texto secundário */
    --brand:#7c3aed;     /* roxo neon */
    --brand-2:#06b6d4;   /* ciano neon */
    --win:#22c55e;       /* sucesso */
    --danger:#ef4444;    /* crash */
    --gold:#f59e0b;      /* destaque */
    --shadow:0 20px 60px rgba(0,0,0,.35);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    color:var(--text); background: radial-gradient(1200px 800px at 10% 10%, #0b1430 0%, #0b0f14 60%),
                       radial-gradient(1000px 800px at 90% 10%, rgba(6,182,212,.12), transparent 60%),
                       radial-gradient(900px 700px at 50% 100%, rgba(124,58,237,.12), transparent 60%),
                       #0b0f14;
    overflow-x:hidden;
  }
  /* Sutileza: partículas de fundo */
  .stars{position:fixed; inset:0; pointer-events:none; background-image:radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,.12) 50%, transparent 52%),
                                  radial-gradient(1.5px 1.5px at 70% 60%, rgba(255,255,255,.09) 50%, transparent 52%),
                                  radial-gradient(1.2px 1.2px at 40% 80%, rgba(255,255,255,.07) 50%, transparent 52%);
          animation: twinkle 6s linear infinite;}
  @keyframes twinkle{50%{opacity:.7}}

  .app{max-width:1100px; margin: clamp(12px, 3vw, 28px) auto; padding: 16px;}

  header{display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:16px}
  .brand{
    display:flex; align-items:center; gap:12px;
    padding:10px 14px; border:1px solid rgba(124,58,237,.35); border-radius:14px;
    background:linear-gradient(135deg, rgba(124,58,237,.12), rgba(6,182,212,.08));
    box-shadow: var(--shadow);
  }
  .brand .logo{width:38px; height:38px; border-radius:10px; background:conic-gradient(from 0deg, var(--brand), var(--brand-2), var(--brand)); filter:brightness(1.2)}
  .brand h1{margin:0; font-size:18px; letter-spacing:.3px}
  .badge-demo{font-size:12px; color:#0b0f14; background:linear-gradient(90deg, var(--gold), #ffd859); padding:.2rem .5rem; border-radius:999px; font-weight:700}

  .grid{display:grid; grid-template-columns: 360px 1fr; gap:16px}
  @media (max-width:900px){ .grid{grid-template-columns: 1fr} }

  /* ===== Painel esquerdo: saldo e apostas ===== */
  .panel{background:linear-gradient(180deg, rgba(18,24,33,.9), rgba(11,15,20,.9)); border:1px solid var(--line); border-radius:20px; padding:16px; box-shadow:var(--shadow)}
  .panel h2{margin:0 0 8px; font-size:16px; color:#cfe1ff; letter-spacing:.3px}

  .balance{display:flex; align-items:center; justify-content:space-between; gap:10px; padding:10px 12px; border:1px solid #1e293b; border-radius:14px; background:linear-gradient(180deg, rgba(20,28,40,.95), rgba(16,22,31,.9));}
  .balance .val{font-size:22px; font-weight:800}
  .chip{font-size:12px; color:var(--muted)}

  .bet-box{ margin-top:12px; display:grid; gap:10px }
  .field{display:grid; gap:6px}
  .label{font-size:12px; color:var(--muted)}
  .input-wrap{display:flex; align-items:center; gap:8px; padding:10px; border:1px solid #1e293b; border-radius:14px; background:linear-gradient(180deg, rgba(22,30,43,.95), rgba(16,22,31,.9));}
  .input-wrap input[type="number"]{flex:1; background:transparent; border:0; outline:0; color:var(--text); font-size:16px}
  .btn-mini{padding:8px 10px; border:1px solid #2a3649; background:#0f1722; color:#cfe1ff; border-radius:10px; cursor:pointer; transition:transform .06s ease, filter .2s;}
  .btn-mini:active{transform:scale(.96)}

  .slider{appearance:none; height:10px; border-radius:999px; background:linear-gradient(90deg, var(--brand), var(--brand-2)); outline:none}
  .slider::-webkit-slider-thumb{appearance:none; width:18px; height:18px; border-radius:50%; background:#fff; border:3px solid #0ea5b6; box-shadow:0 0 0 6px rgba(6,182,212,.2)}

  .actions{display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-top:10px}
  .btn{
    padding:14px 16px; border-radius:14px; border:1px solid #243041; background:linear-gradient(180deg, rgba(30,41,59,1), rgba(12,18,27,1)); color:#e6f0ff; cursor:pointer; font-weight:800; letter-spacing:.5px; text-transform:uppercase; box-shadow: var(--shadow);
    position:relative; overflow:hidden; transition: transform .08s ease, filter .2s, border-color .2s;
  }
  .btn:hover{filter:brightness(1.1); border-color:#2e3e55}
  .btn:active{transform: translateY(1px)}
  .btn-brand{ background:linear-gradient(90deg, rgba(124,58,237,.95), rgba(6,182,212,.95)); border-color:transparent }
  .btn-win{ background:linear-gradient(90deg, rgba(34,197,94,.95), rgba(6,182,212,.95)); border-color:transparent }
  .btn-danger{ background:linear-gradient(90deg, rgba(239,68,68,.95), rgba(244,63,94,.95)); border-color:transparent }
  .btn[disabled]{opacity:.6; cursor:not-allowed; filter:grayscale(.4)}
  .ripple{position:absolute; border-radius:50%; transform: translate(-50%, -50%); pointer-events:none; width:6px; height:6px; background:rgba(255,255,255,.8); animation: ripple .6s ease-out}
  @keyframes ripple{ from{opacity:.7; transform:translate(-50%, -50%) scale(1);} to{opacity:0; transform:translate(-50%, -50%) scale(30);} }

  /* ===== Área do jogo ===== */
  .game{position:relative; background:linear-gradient(180deg, rgba(8,13,20,.9), rgba(7,10,15,.96)); border:1px solid var(--line); border-radius:20px; padding:16px; overflow:hidden; box-shadow:var(--shadow)}
  .sky{position:relative; height:340px; border-radius:14px; background:linear-gradient(180deg, rgba(19,27,39,.85), rgba(14,20,28,.85)); overflow:hidden}
  .horizon{position:absolute; left:0; right:0; bottom:0; height:3px; background:linear-gradient(90deg, rgba(124,58,237,.8), rgba(6,182,212,.8)); box-shadow:0 0 20px rgba(124,58,237,.6)}

  .plane{position:absolute; left:20px; bottom:60px; width:66px; height:42px; transform-origin:center; filter: drop-shadow(0 8px 14px rgba(0,0,0,.35));}
  .plane svg{display:block}
  .flame{position:absolute; left:-8px; top:16px; width:18px; height:8px; border-radius:8px; background: radial-gradient(circle at 30% 50%, #fff, #ffd04d 35%, #ff7849 60%, transparent 70%); filter: blur(1px) brightness(1.2); animation: flame .2s infinite alternate}
  @keyframes flame{ from{ transform:scaleX(1) } to{ transform: scaleX(1.2) }
  }

  .multiplier{position:absolute; top:16px; left:16px; font-weight:900; letter-spacing:.5px; font-size: clamp(28px, 7vw, 58px); text-shadow:0 6px 28px rgba(124,58,237,.35), 0 0 60px rgba(6,182,212,.25)}
  .multiplier small{font-weight:600; font-size:.35em; color:var(--muted)}

  .status{position:absolute; top:16px; right:16px; font-size:13px; color:#0b0f14; font-weight:900; background:linear-gradient(90deg, var(--brand), var(--brand-2)); padding:.4rem .7rem; border-radius:999px; letter-spacing:.6px; text-transform:uppercase}
  .status.crashed{background:linear-gradient(90deg, var(--danger), #fb7185)}
  .status.ready{background:linear-gradient(90deg, #64748b, #94a3b8)}

  .pop{position:absolute; pointer-events:none; font-weight:900; color:var(--win); text-shadow:0 0 18px rgba(34,197,94,.5)}

  /* Histórico */
  .history{margin-top:14px; display:flex; gap:8px; flex-wrap:wrap}
  .tag{padding:.35rem .6rem; border-radius:10px; font-weight:800; font-size:12px; border:1px solid #243041}
  .tag.red{color:#fecaca; background:linear-gradient(180deg, rgba(127,29,29,.35), rgba(69,10,10,.35))}
  .tag.yellow{color:#fef9c3; background:linear-gradient(180deg, rgba(113,63,18,.35), rgba(67,20,7,.35))}
  .tag.green{color:#dcfce7; background:linear-gradient(180deg, rgba(22,101,52,.35), rgba(15,65,34,.35))}
  .tag.purple{color:#ede9fe; background:linear-gradient(180deg, rgba(76,29,149,.35), rgba(48,19,102,.35))}

  /* Canvas efeitos */
  canvas#fx{position:absolute; inset:0; pointer-events:none}

  footer{margin-top:18px; color:var(--muted); font-size:12px; line-height:1.5}
  footer b{color:#ffe69b}
</style>
</head>
<body>
  <div class="stars"></div>
  <div class="app">
    <header>
      <div class="brand">
        <div class="logo"></div>
        <div>
          <h1>Aviador</h1>
          <div class="chip">Demo educativa • créditos virtuais</div>
        </div>
      </div>
      <div class="badge-demo">BETA</div>
    </header>

    <div class="grid">
      <!-- Painel esquerdo -->
      <section class="panel">
        <h2>Carteira</h2>
        <div class="balance">
          <div class="chip">Saldo</div>
          <div class="val" id="saldo">R$ 0,00</div>
        </div>

        <div class="bet-box">
          <div class="field">
            <div class="label">Valor da aposta (R$)</div>
            <div class="input-wrap">
              <button class="btn-mini" data-step="-50">−50</button>
              <button class="btn-mini" data-step="-10">−10</button>
              <input id="bet" type="number" min="1" step="1" value="20" />
              <button class="btn-mini" data-step="10">+10</button>
              <button class="btn-mini" data-step="50">+50</button>
              <button class="btn-mini" id="max">MAX</button>
            </div>
          </div>

          <div class="field">
            <div class="label">Auto cashout (<span id="autoVal">1.50</span>x)</div>
            <input id="auto" class="slider" type="range" min="1.10" max="10" step="0.01" value="1.50" />
          </div>

          <div class="actions">
            <button id="start" class="btn btn-brand">Iniciar rodada</button>
            <button id="cash" class="btn btn-win" disabled>Cash Out</button>
          </div>

          <div class="actions">
            <button id="add100" class="btn">+ R$ 100 de crédito</button>
            <button id="reset" class="btn btn-danger">Zerar histórico</button>
          </div>
        </div>
      </section>

      <!-- Área do jogo -->
      <section class="game">
        <div class="sky" id="sky">
          <div class="multiplier" id="mult">1.00x <small>aguardando…</small></div>
          <div class="status ready" id="status">Pronto</div>
          <div class="plane" id="plane">
            <!-- foguete estilizado -->
            <div class="flame"></div>
            <svg viewBox="0 0 80 50" width="80" height="50" aria-hidden="true">
              <defs>
                <linearGradient id="g1" x1="0%" x2="100%">
                  <stop offset="0%" stop-color="#7c3aed"/>
                  <stop offset="100%" stop-color="#06b6d4"/>
                </linearGradient>
              </defs>
              <path d="M60 25 L25 10 L25 40 Z" fill="url(#g1)"/>
              <rect x="25" y="18" width="18" height="14" rx="3" fill="#a78bfa"/>
              <circle cx="54" cy="25" r="5" fill="#60a5fa"/>
              <rect x="15" y="21" width="12" height="8" rx="2" fill="#94a3b8"/>
            </svg>
          </div>
          <div class="horizon"></div>
          <canvas id="fx"></canvas>
        </div>
        <div class="history" id="history"></div>
      </section>
    </div>

    <footer>
      <p><b>Aviso:</b> este é um protótipo <b>educativo</b> com créditos virtuais. Se for adaptar para dinheiro real, você é responsável por cumprir as leis e regras da sua jurisdição, KYC/AML, idade mínima e mecanismos de jogo responsável. Considere também publicar um algoritmo provably-fair.</p>
    </footer>
  </div>

<script>
(function(){
  // ===== Estado =====
  const fmt = v => v.toLocaleString('pt-BR',{style:'currency',currency:'BRL'});
  const $ = sel => document.querySelector(sel);
  const saldoEl = $('#saldo');
  const betEl = $('#bet');
  const autoEl = $('#auto');
  const autoVal = $('#autoVal');
  const startBtn = $('#start');
  const cashBtn  = $('#cash');
  const statusEl = $('#status');
  const multEl = $('#mult');
  const historyEl = $('#history');
  const planeEl = $('#plane');
  const skyEl = $('#sky');
  const canvas = $('#fx');
  const ctx = canvas.getContext('2d');

  let saldo = Number(localStorage.getItem('aviador_saldo')||'1000');
  let history = JSON.parse(localStorage.getItem('aviador_hist')||'[]');
  let inRound = false, crashed=false, cashed=false;
  let bet=Number(betEl.value), mult=1.00, crashAt=2.0, t0=0, raf=0;

  // ===== Ajuste de layout =====
  function resize(){ canvas.width = skyEl.clientWidth; canvas.height = skyEl.clientHeight; }
  addEventListener('resize', resize, {passive:true}); resize();

  // ===== UI inicial =====
  function renderSaldo(){ saldoEl.textContent = fmt(saldo); }
  function pushHistory(x){ history.unshift(x); history=history.slice(0,12); localStorage.setItem('aviador_hist', JSON.stringify(history)); drawHistory(); }
  function drawHistory(){
    historyEl.innerHTML = '';
    history.forEach(x=>{
      const tag = document.createElement('div');
      tag.className = 'tag ' + (x<1.5?'red':x<2?'yellow':x<5?'green':'purple');
      tag.textContent = x.toFixed(2)+'x';
      historyEl.appendChild(tag);
    });
  }

  renderSaldo(); drawHistory();
  autoVal.textContent = Number(autoEl.value).toFixed(2);

  // ===== Utilidades =====
  function clickRipple(evt){
    const b = evt.currentTarget; const r = document.createElement('span');
    r.className='ripple'; const rect = b.getBoundingClientRect();
    r.style.left = (evt.clientX - rect.left) + 'px'; r.style.top = (evt.clientY - rect.top) + 'px';
    b.appendChild(r); setTimeout(()=>r.remove(), 600);
  }
  document.querySelectorAll('.btn, .btn-mini').forEach(b=> b.addEventListener('click', clickRipple));

  function beep(freq=880, ms=100, type='sine', gain=.03){
    try{
      const actx = new (window.AudioContext||window.webkitAudioContext)();
      const o = actx.createOscillator(); const g = actx.createGain();
      o.type = type; o.frequency.value = freq; g.gain.value = gain;
      o.connect(g).connect(actx.destination); o.start();
      setTimeout(()=>{o.stop(); actx.close();}, ms);
    }catch{ /* sem áudio */ }
  }

  function popText(text, color){
    const span = document.createElement('div');
    span.className='pop';
    span.textContent = text;
    span.style.left = (canvas.width/2 - 20 + (Math.random()*40-20)) + 'px';
    span.style.top = (canvas.height/2 - 40) + 'px';
    span.style.color = color || 'var(--win)';
    skyEl.appendChild(span);
    let y=0, op=1; const id=setInterval(()=>{ y-=1.4; op-=.02; span.style.transform=`translateY(${y}px)`; span.style.opacity=op.toFixed(2); if(op<=0){ clearInterval(id); span.remove(); } }, 16);
  }

  // Partículas simples (confete)
  let particles=[]; const gravity=.12;
  function burst(color){
    for(let i=0;i<90;i++){
      particles.push({x:canvas.width/2, y:canvas.height/2, vx:(Math.random()*6-3), vy:(-Math.random()*4-2), life:60+Math.random()*40, c:color});
    }
  }
  function drawFx(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    particles = particles.filter(p=>p.life>0);
    particles.forEach(p=>{ p.life--; p.x+=p.vx; p.y+=p.vy; p.vy+=gravity; ctx.globalAlpha = Math.max(0, p.life/100); ctx.fillStyle = p.c || '#fff'; ctx.fillRect(p.x, p.y, 3, 3); ctx.globalAlpha = 1; });
  }

  // ===== Lógica do jogo =====
  function sampleCrash(){
    // Distribuição com cauda pesada, limitada em 50x (ajustável)
    const u = crypto.getRandomValues(new Uint32Array(1))[0] / 2**32; // [0,1)
    const house = 0.99; // pseudo "house edge" de 1%
    let m = (house) / (1 - u); // 1/(1-u)
    if (!Number.isFinite(m) || m<1) m = 1;
    return Math.min(50, m); // limite prático para animação
  }

  function resetRoundUI(){
    statusEl.textContent = 'Pronto'; statusEl.className='status ready';
    multEl.innerHTML = '1.00x <small>aguardando…</small>';
    planeEl.style.transform = `translate(0,0) rotate(0deg)`;
  }

  function startRound(){
    if(inRound) return; bet = Math.max(1, Math.floor(Number(betEl.value)||0));
    if(bet>saldo){ alert('Saldo insuficiente.'); return; }

    inRound = true; crashed=false; cashed=false; crashAt = sampleCrash();
    saldo -= bet; localStorage.setItem('aviador_saldo', String(saldo)); renderSaldo();

    statusEl.textContent = 'Decolando…'; statusEl.className='status';
    mult = 1.00; t0 = performance.now();

    // Som de decolagem
    beep(440,90,'square',.04); setTimeout(()=>beep(660,90,'square',.04), 110);

    cancelAnimationFrame(raf); loop();
  }

  function loop(now){
    if(!inRound){ drawFx(); return; }
    raf = requestAnimationFrame(loop);

    const rate = 0.62; // taxa de crescimento exponencial
    const t = (performance.now()-t0)/1000; // segundos
    mult = Math.max(1, Math.min(9999, Math.exp(rate*t)));

    // Atualiza UI
    multEl.innerHTML = `${mult.toFixed(2)}x <small>meta ${Number(autoEl.value).toFixed(2)}x • crash em ?</small>`;

    // Move o avião conforme multiplicador
    const progress = Math.min(1, (mult-1)/9); // atinge 100% por volta de ~10x
    const x = progress * (skyEl.clientWidth - 120);
    const y = Math.sin(progress*2.2) * 14; // leve ondulação
    const tilt = Math.min(22, progress*28);
    planeEl.style.transform = `translate(${x}px, ${-y}px) rotate(${tilt}deg)`;

    // Efeitos
    drawFx();

    // Auto cashout
    const auto = Number(autoEl.value);
    if(!cashed && mult >= auto){ doCashout(); }

    // Crash?
    if(mult >= crashAt){
      crash();
    }
  }

  function crash(){
    inRound=false; crashed=true; cancelAnimationFrame(raf);
    statusEl.textContent='Crash!'; statusEl.className='status crashed';
    multEl.innerHTML = `${crashAt.toFixed(2)}x <small>o avião caiu</small>`;

    // Perdeu a aposta
    popText('−'+fmt(bet), 'var(--danger)');
    pushHistory(crashAt);

    // som de falha
    beep(220,180,'sawtooth',.05); setTimeout(()=>beep(196,120,'sawtooth',.04), 160);

    // tremor e flash
    skyEl.animate([{filter:'brightness(1)'},{filter:'brightness(1.7)'},{filter:'brightness(1)'}],{duration:360});
    skyEl.animate([{transform:'translateX(0)'},{transform:'translateX(-5px)'},{transform:'translateX(5px)'},{transform:'translateX(0)'}],{duration:260});

    // fumacinha (partículas escuras)
    for(let i=0;i<60;i++) particles.push({x:planeEl.offsetLeft+30, y:canvas.height-80, vx:(Math.random()*2-1), vy:(-Math.random()*2), life:70+Math.random()*20, c:'rgba(15,23,42,.6)'});

    // rearmar botões
    cashBtn.disabled = true; startBtn.disabled=false; startBtn.textContent='Nova rodada';
  }

  function doCashout(){
    if(!inRound||cashed) return;
    cashed=true; inRound=false; cancelAnimationFrame(raf);

    const ganho = Math.floor(bet * mult * 100)/100;
    saldo += ganho; localStorage.setItem('aviador_saldo', String(saldo)); renderSaldo();

    statusEl.textContent='Cash Out!'; statusEl.className='status';
    multEl.innerHTML = `${mult.toFixed(2)}x <small>lucro: ${fmt(ganho-bet)}</small>`;

    popText('+'+fmt(ganho), 'var(--win)');
    burst('#34d399'); burst('#06b6d4');
    pushHistory(mult);

    // som de vitória
    beep(523,120,'triangle',.05); setTimeout(()=>beep(659,120,'triangle',.05), 130); setTimeout(()=>beep(784,120,'triangle',.05), 260);

    cashBtn.disabled=true; startBtn.disabled=false; startBtn.textContent='Nova rodada';
  }

  // ===== Eventos =====
  autoEl.addEventListener('input', ()=>{ autoVal.textContent = Number(autoEl.value).toFixed(2); });

  startBtn.addEventListener('click', ()=>{
    startBtn.blur(); cashBtn.disabled=false; startBtn.disabled=true; startBtn.textContent='Rodando…';
    resetAnimations(); startRound();
  });

  cashBtn.addEventListener('click', ()=>{ doCashout(); });

  document.querySelectorAll('.btn-mini').forEach(b=>{
    b.addEventListener('click', ()=>{
      const step = Number(b.dataset.step||0);
      if(b.id==='max') betEl.value = Math.max(1, Math.floor(saldo));
      else betEl.value = Math.max(1, Math.floor((Number(betEl.value)||0) + step));
    })
  });

  $('#add100').addEventListener('click', ()=>{ saldo+=100; localStorage.setItem('aviador_saldo', String(saldo)); renderSaldo(); popText('+ R$ 100', 'var(--gold)'); burst('#f59e0b');});
  $('#reset').addEventListener('click', ()=>{ if(confirm('Zerar histórico e redefinir saldo para R$ 1.000,00?')){ history=[]; localStorage.removeItem('aviador_hist'); drawHistory(); saldo=1000; localStorage.setItem('aviador_saldo','1000'); renderSaldo(); }});

  function resetAnimations(){
    planeEl.style.transition='none'; planeEl.style.transform='translate(0,0)';
    setTimeout(()=>{ planeEl.style.transition='transform .12s linear'; }, 20);
  }

  // Ticker para efeitos
  setInterval(drawFx, 16);
  resetRoundUI();
})();
</script>
</body>
</html>
